<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Game Ti√™u Di·ªát T·∫ø B√†o Ung Th∆∞</title>
<style>
body{
 margin:0;font-family:Arial;
 background:radial-gradient(circle,#0f2027,#203a43,#2c5364);
 color:white;text-align:center
}
.hidden{display:none}
h1{color:#ff5252}

#bags{
 max-width:720px;margin:30px auto;
 display:grid;grid-template-columns:repeat(4,1fr);gap:20px
}
.bag{
 background:rgba(255,255,255,.15);
 border-radius:20px;padding:20px;
 cursor:pointer;transition:.3s
}
.bag:hover{transform:scale(1.1)}
.bag span{font-size:48px}

#questionBox{
 max-width:900px;margin:30px auto;
 background:rgba(0,0,0,.45);
 padding:25px;border-radius:20px
}
.option{
 background:#1e3c72;padding:12px;
 margin:10px 0;border-radius:12px;
 cursor:pointer
}
.option:hover{background:#2a5298}
.wrong{background:#e74c3c!important;animation:shake .4s}

.statement{
 background:#102542;padding:12px;
 margin:10px 0;border-radius:12px;
 display:flex;justify-content:space-between;align-items:center
}
.tf button{
 padding:6px 14px;border:none;
 border-radius:20px;margin-left:8px;
 cursor:pointer
}

input{
 padding:10px;width:80%;
 border-radius:10px;border:none
}
button{
 padding:10px 18px;border:none;
 border-radius:20px;cursor:pointer;
 font-weight:bold;margin:6px
}

#virus{font-size:120px;animation:pop .6s}
@keyframes pop{50%{transform:scale(1.4)}}
@keyframes shake{
 25%{transform:translateX(-6px)}
 50%{transform:translateX(6px)}
 75%{transform:translateX(-6px)}
}

#msg{
 position:fixed;top:40%;left:50%;
 transform:translate(-50%,-50%);
 background:#c62828;
 padding:20px 30px;
 border-radius:20px;font-size:22px
}
</style>
</head>
<body>

<h1>üß¨ GAME TI√äU DI·ªÜT T·∫æ B√ÄO UNG TH∆Ø</h1>

<div id="home"><div id="bags"></div></div>
<div id="question" class="hidden"><div id="questionBox"></div></div>
<div id="success" class="hidden"><div id="virus">ü¶†</div><h2>TI√äU DI·ªÜT TH√ÄNH C√îNG!</h2></div>
<div id="msg" class="hidden">‚ùå TI√äU DI·ªÜT TH·∫§T B·∫†I</div>

<audio id="sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2c7e6d9b1b.mp3"></audio>

<script>
const bagsDiv = document.getElementById("bags");
const qBox = document.getElementById("questionBox");
const home = document.getElementById("home");
const question = document.getElementById("question");
const successBox = document.getElementById("success");
const msg = document.getElementById("msg");
const sound = document.getElementById("sound");

let destroyedBags = [];
let usedQuestions = [];   // ‚ùó ƒê√É D√ôNG ‚Üí KH√îNG L·∫∂P

const shuffle = a => a.sort(() => Math.random() - 0.5);

/* ===================== DATA C√ÇU H·ªéI ===================== */
let questionPool = shuffle([
 // ABCD
 {type:"mc",q:"Gen ƒë·ªôt bi·∫øn ph·ªï bi·∫øn nh·∫•t trong ung th∆∞ ng∆∞·ªùi?",o:["p53","rRNA","tRNA","lacZ"],a:"p53"},
 {type:"mc",q:"Oncogene c√≥ ngu·ªìn g·ªëc t·ª´?",o:["Proto-oncogene","Plasmid","Operon","Gen c·∫•u tr√∫c"],a:"Proto-oncogene"},
 {type:"mc",q:"C∆° ch·∫ø ch√≠nh c·ªßa x·∫° tr·ªã ung th∆∞?",o:["G√¢y ƒë·ª©t g√£y DNA","ƒê√¥ng protein","Ph√° m√†ng t·∫ø b√†o","·ª®c ch·∫ø ribosome"],a:"G√¢y ƒë·ª©t g√£y DNA"},

 // Tr·∫£ l·ªùi ng·∫Øn
 {type:"short",q:"Qu√° tr√¨nh t·∫ø b√†o t·ª± ch·∫øt c√≥ ki·ªÉm so√°t g·ªçi l√† g√¨?",a:"apoptosis"},
 {type:"short",q:"Gen ·ª©c ch·∫ø kh·ªëi u li√™n quan ung th∆∞ v√∫ di truy·ªÅn?",a:"brca1"},
 {type:"short",q:"ƒê·ªôt bi·∫øn x·∫£y ra ·ªü t·∫ø b√†o soma g·ªçi l√† g√¨?",a:"ƒë·ªôt bi·∫øn soma"},

 // ƒê√∫ng / Sai
 {type:"tf",q:"C∆° ch·∫ø ph√¢n t·ª≠ c·ªßa ung th∆∞",s:[
  ["ƒê·ªôt bi·∫øn p53 l√†m m·∫•t ki·ªÉm so√°t chu k√¨ t·∫ø b√†o",true],
  ["Oncogene c·∫ßn c·∫£ hai alen b·ªã ƒë·ªôt bi·∫øn",false],
  ["Apoptosis th∆∞·ªùng b·ªã ·ª©c ch·∫ø trong t·∫ø b√†o ung th∆∞",true],
  ["Ung th∆∞ kh√¥ng li√™n quan ƒë·∫øn ƒë·ªôt bi·∫øn DNA",false]
 ]},
 {type:"tf",q:"ƒêi·ªÅu tr·ªã ung th∆∞ hi·ªán ƒë·∫°i",s:[
  ["X·∫° tr·ªã g√¢y ƒë·ª©t g√£y m·∫°ch ƒë√¥i DNA",true],
  ["H√≥a tr·ªã ch·ªâ t√°c ƒë·ªông t·∫ø b√†o ung th∆∞",false],
  ["Mi·ªÖn d·ªãch tr·ªã li·ªáu k√≠ch ho·∫°t t·∫ø b√†o T",true],
  ["Li·ªáu ph√°p ƒë√≠ch nh·∫Øm protein ƒë·∫∑c hi·ªáu",true]
 ]}
]);

/* ===================== RENDER T√öI ===================== */
function renderBags(){
 bagsDiv.innerHTML="";
 for(let i=0;i<8;i++){
  if(destroyedBags.includes(i)) continue;
  bagsDiv.innerHTML+=`
   <div class="bag" onclick="openBag(${i})">
    <span>ü¶†</span><br>T·∫ø b√†o ${i+1}
   </div>`;
 }
}

/* ===================== OPEN BAG ===================== */
function openBag(bagIndex){
 if(questionPool.length === 0){
   alert("ƒê√£ h·∫øt c√¢u h·ªèi!");
   return;
 }

 const q = questionPool.shift(); // ‚ùó L·∫§Y & LO·∫†I LU√îN
 usedQuestions.push(q);

 home.classList.add("hidden");
 question.classList.remove("hidden");
 qBox.innerHTML = "<h2>"+q.q+"</h2>";

 if(q.type==="mc"){
  shuffle(q.o).forEach(op=>{
   qBox.innerHTML+=`
    <div class="option" onclick="${op===q.a?'win':'lose'}(${bagIndex})">
     <b>${"ABCD"[q.o.indexOf(op)]}.</b> ${op}
    </div>`;
  });
 }

 if(q.type==="short"){
  qBox.innerHTML+=`
   <input id="ans">
   <br>
   <button onclick="checkShort(${bagIndex},'${q.a}')">X√°c nh·∫≠n</button>
   <button onclick="document.getElementById('real').classList.toggle('hidden')">Xem ƒë√°p √°n</button>
   <div id="real" class="hidden">ƒê√°p √°n: ${q.a}</div>`;
 }

 if(q.type==="tf"){
  shuffle(q.s).forEach(([t,a])=>{
   qBox.innerHTML+=`
   <div class="statement">${t}
    <div class="tf">
     <button onclick="${a?'tfOk':'tfFail'}(${bagIndex})">ƒê√∫ng</button>
     <button onclick="${!a?'tfOk':'tfFail'}(${bagIndex})">Sai</button>
    </div>
   </div>`;
  });
 }
}

/* ===================== RESULT ===================== */
function win(i){
 sound.play();
 destroyedBags.push(i);
 question.classList.add("hidden");
 successBox.classList.remove("hidden");
 setTimeout(()=>{
  successBox.classList.add("hidden");
  home.classList.remove("hidden");
  renderBags();
 },1200);
}

function lose(){
 question.classList.add("hidden");
 msg.classList.remove("hidden");
 setTimeout(()=>{
  msg.classList.add("hidden");
  home.classList.remove("hidden");
 },1200);
}

const tfOk = () => {};
const tfFail = () => lose();
const checkShort = (i,a)=>{
 document.getElementById("ans").value.toLowerCase().trim()===a?win(i):lose();
};

renderBags();
</script>
</body>
</html>
